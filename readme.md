# Реализация тестовых заданий на вакансию Data Engineer

# Использование

- `python - 3.12.x`
- запуск команды `pip install -r requirements.txt`
- заполнение [`config.ini`](config.ini)
- запуск команды  `python app\main.py`

# config.ini

#### `[database]`
`SCHEMA` - Название схемы
`DB_USER` - Пользователь бд 
`DB_PASS` - Пароль пользователя
`DB_NAME` - Название бд
`DB_HOST` - Хост бд
`DB_PORT` - Порт бд
`DB_SSLM` - ssl mode

#### `[wb_api]`
`TOKEN` - Токен для wb api

---
## Задание 1 – FIFO
В БД есть таблицы `SALES` и `SUPPLY`.
В `SALES` массив продаж - айдишники товаров, продажи в штуках и даты продаж.
В `SUPPLY` массив поставок – айдишники товаров, количество товаров в поставке, номер поставки и себестоимость штуки товара внутри поставки.
Необходимо произвести расчёт себестоимости проданного по модели FIFO (first in – first out, первый пришёл – первый ушёл). Поставки ранжируются от более старых к более новым по возрастанию номера поставки. Продажи списывают себестоимость товара сначала из первой партии, когда она заканчивается из второй и так далее. Добавить группировку по году-месяцу в формате `YYYY-MM` для сверки контрольных сумм.
В результате представить файл запроса `.sql` и выгрузку полученных результатов в формате `.xlsx`

#### Реализация - `app\task1.py`
---
## Задание 2 – WB API
Используя Wildberries API подключитесь к нему и выгрузите с него все доступные данные по заказам, добавьте графу с текущей датой и временем, а также графу со своим именем и загрузите его в базу данных "`db`", в таблицу "`WB API`"

**предоставляется токен тестового контура**

Графы, которые нужно оставить:
`nmId` `warehouseName` `regionName` `gNumber` `srid` `date`
Графы которые нужно создать:
`Upload Date`: текущая дата формата Time without timezone (Datetime)
`Name`: Ваша фамилия и имя
В результате представить файл кода .py

#### Реализация - `app\task2.py`